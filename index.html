<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>KRAKINS: –ö–æ—Å—Ç—è –°–æ–∫–æ–ª–æ–≤</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Arial', sans-serif;
      background: #000022;
      color: white;
    }

    canvas {
      display: block;
      margin: auto;
      background: radial-gradient(#001f33, #000);
      border: 4px solid cyan;
    }

    #menu {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.85);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    #menu h1 {
      font-size: 48px;
      margin-bottom: 30px;
      text-shadow: 0 0 10px cyan;
    }

    #startBtn {
      font-size: 24px;
      padding: 15px 40px;
      border: none;
      background-color: cyan;
      color: black;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }

    #startBtn:hover {
      background-color: white;
    }

    #score, #game-over {
      position: absolute;
      font-size: 20px;
      z-index: 5;
    }

    #score {
      top: 10px;
      left: 10px;
    }

    #game-over {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 36px;
      text-align: center;
      display: none;
    }

    #restartBtn {
      margin-top: 20px;
      padding: 10px 30px;
      font-size: 18px;
      background-color: cyan;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

  </style>
</head>
<body>

  <div id="menu">
    <h1>KRAKINS: –ö–æ—Å—Ç—è –°–æ–∫–æ–ª–æ–≤</h1>
    <button id="startBtn">–ò–≥—Ä–∞—Ç—å</button>
  </div>

  <canvas id="gameCanvas" width="800" height="600"></canvas>
  <div id="score">–°—á—ë—Ç: 0</div>

  <div id="game-over">
    <div>üíÄ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</div>
    <button id="restartBtn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    const menu = document.getElementById('menu');
    const startBtn = document.getElementById('startBtn');
    const gameOverScreen = document.getElementById('game-over');
    const restartBtn = document.getElementById('restartBtn');
    const scoreEl = document.getElementById('score');

    let player, keys, torpedoes, bonuses, score, gameOver, frame;

    function initGame() {
      player = {
        x: 400,
        y: 300,
        size: 25,
        speed: 4,
        color: 'lime'
      };

      keys = {};
      torpedoes = [];
      bonuses = [];
      score = 0;
      gameOver = false;
      frame = 0;

      gameOverScreen.style.display = 'none';
      scoreEl.textContent = "–°—á—ë—Ç: 0";
      animate();
    }

    startBtn.onclick = () => {
      menu.style.display = 'none';
      initGame();
    };

    restartBtn.onclick = () => {
      initGame();
    };

    document.addEventListener('keydown', e => keys[e.key] = true);
    document.addEventListener('keyup', e => keys[e.key] = false);

    function drawPlayer() {
      ctx.fillStyle = player.color;
      ctx.beginPath();
      ctx.arc(player.x, player.y, player.size, 0, Math.PI * 2);
      ctx.fill();
    }

    function movePlayer() {
      if (keys['ArrowLeft'] && player.x - player.size > 0) player.x -= player.speed;
      if (keys['ArrowRight'] && player.x + player.size < canvas.width) player.x += player.speed;
      if (keys['ArrowUp'] && player.y - player.size > 0) player.y -= player.speed;
      if (keys['ArrowDown'] && player.y + player.size < canvas.height) player.y += player.speed;
    }

    function spawnTorpedo() {
      const dir = Math.floor(Math.random() * 4);
      const speed = 2 + score / 100;
      let t = { x: 0, y: 0, dx: 0, dy: 0, size: 20, speed: speed };

      switch (dir) {
        case 0: t.x = 0; t.y = Math.random() * canvas.height; t.dx = 1; break;
        case 1: t.x = canvas.width; t.y = Math.random() * canvas.height; t.dx = -1; break;
        case 2: t.x = Math.random() * canvas.width; t.y = 0; t.dy = 1; break;
        case 3: t.x = Math.random() * canvas.width; t.y = canvas.height; t.dy = -1; break;
      }

      torpedoes.push(t);
    }

    function drawTorpedoes() {
      ctx.fillStyle = 'red';
      for (let t of torpedoes) {
        ctx.beginPath();
        ctx.rect(t.x, t.y, t.size, t.size);
        ctx.fill();
      }
    }

    function moveTorpedoes() {
      for (let t of torpedoes) {
        t.x += t.dx * t.speed;
        t.y += t.dy * t.speed;
      }
    }

    function checkCollision() {
      for (let t of torpedoes) {
        const dist = Math.hypot(player.x - t.x, player.y - t.y);
        if (dist < player.size + t.size / 2) {
          gameOver = true;
          gameOverScreen.style.display = 'block';
        }
      }
    }

    function spawnBonus() {
      if (Math.random() < 0.01) {
        bonuses.push({
          x: Math.random() * (canvas.width - 20) + 10,
          y: Math.random() * (canvas.height - 20) + 10,
          size: 10
        });
      }
    }

    function drawBonuses() {
      ctx.fillStyle = 'yellow';
      for (let b of bonuses) {
        ctx.beginPath();
        ctx.arc(b.x, b.y, b.size, 0, Math.PI * 2);
        ctx.fill();
      }
    }

    function checkBonus() {
      for (let i = bonuses.length - 1; i >= 0; i--) {
        const b = bonuses[i];
        const dist = Math.hypot(player.x - b.x, player.y - b.y);
        if (dist < player.size + b.size) {
          score += 10;
          bonuses.splice(i, 1);
        }
      }
    }

    function updateScore() {
      scoreEl.textContent = '–°—á—ë—Ç: ' + score;
    }

    function animate() {
      if (gameOver) return;
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      movePlayer();
      drawPlayer();

      if (frame % 60 === 0) spawnTorpedo();
      moveTorpedoes();
      drawTorpedoes();

      spawnBonus();
      drawBonuses();
      checkBonus();

      checkCollision();
      updateScore();

      frame++;
      score += 1;

      requestAnimationFrame(animate);
    }
  </script>

</body>
</html>
